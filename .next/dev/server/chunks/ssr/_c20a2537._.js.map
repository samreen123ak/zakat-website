{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sam_Bhatti/Desktop/Rahmah%20Exchange/Frontend/lib/auth-utils.ts"],"sourcesContent":["export const AUTH_TOKEN_KEY = \"rahmah_admin_token\"\n\n// Save token in cookies (for middleware)\nexport function setAuthToken(token: string): void {\n  if (typeof window === \"undefined\") return\n  // Cookie expires in 1 hour\n  document.cookie = `${AUTH_TOKEN_KEY}=${token}; path=/; max-age=3600; secure; samesite=lax`\n}\n\n// Get token from cookies (for client-side checks)\nexport function getAuthToken(): string | null {\n  if (typeof window === \"undefined\") return null\n  const match = document.cookie.match(new RegExp('(^| )' + AUTH_TOKEN_KEY + '=([^;]+)'))\n  return match ? match[2] : null\n}\n\n// Remove token from cookies\nexport function removeAuthToken(): void {\n  if (typeof window === \"undefined\") return\n  document.cookie = `${AUTH_TOKEN_KEY}=; path=/; max-age=0`\n}\n\n// Client-side helper\nexport function isAuthenticated(): boolean {\n  return !!getAuthToken()\n}\n\n// Keep API base URL as is\nexport const API_BASE_URL =\n  process.env.NEXT_PUBLIC_API_URL || \"https://rahmah-exchange-backend-production.up.railway.app\"\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAO,MAAM,iBAAiB;AAGvB,SAAS,aAAa,KAAa;IACxC,wCAAmC;;;AAGrC;AAGO,SAAS;IACd,wCAAmC,OAAO;;;IAC1C,MAAM;AAER;AAGO,SAAS;IACd,wCAAmC;;;AAErC;AAGO,SAAS;IACd,OAAO,CAAC,CAAC;AACX;AAGO,MAAM,eACX,iGAAmC","debugId":null}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sam_Bhatti/Desktop/Rahmah%20Exchange/Frontend/app/staff/dashboard/page.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useEffect, useState } from \"react\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/navigation\"\nimport { CheckCircle2, TrendingUp, FileText, Heart, LogOut, Shield } from \"lucide-react\"\nimport { removeAuthToken, getAuthToken, API_BASE_URL } from \"@/lib/auth-utils\"\n\ntype ZakatApplicant = {\n  id?: string | number\n  status?: string\n  createdAt?: string\n  normalizedStatus?: string\n  [key: string]: any\n}\n\ntype StatCardProps = {\n  title: string\n  value: string | number\n  icon: React.ReactNode\n  color?: string\n}\n\ntype StatusRowProps = {\n  label: string\n  value: number\n  color: string\n}\n\nexport default function DashboardPage() {\n  const [activeTab] = useState(\"overview\")\n  const [applicants, setApplicants] = useState<ZakatApplicant[]>([])\n  const [totalFromAPI, setTotalFromAPI] = useState<number | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [showDebug] = useState(false)\n  const router = useRouter()\n\n  useEffect(() => {\n    const token = getAuthToken()\n    if (!token) {\n      router.push(\"/staff/login\")\n      return\n    }\n  }, [router])\n\n  const normalizeStatus = (status?: string) => {\n    return (status || \"\").toString().trim().toLowerCase().replace(/\\s+/g, \" \")\n  }\n\n  const handleLogout = async () => {\n    try {\n      const token = getAuthToken()\n      if (token) {\n        await fetch(`${API_BASE_URL}/api/auth/logout`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n        }).catch(() => {})\n      }\n      removeAuthToken()\n      router.push(\"/staff/login\")\n    } catch (err) {\n      console.error(\"Logout failed:\", err)\n      removeAuthToken()\n      router.push(\"/staff/login\")\n    }\n  }\n\n  useEffect(() => {\n    const fetchApplicants = async () => {\n      try {\n        const res = await fetch(`${API_BASE_URL}/api/zakatApplicants`)\n        const json = await res.json()\n\n        const dataArray: any[] = Array.isArray(json) ? json : json.items || json.data || []\n\n        const normalizedArray: ZakatApplicant[] = dataArray.map((a) => ({\n          ...a,\n          normalizedStatus: normalizeStatus(a?.status),\n        }))\n\n        setApplicants(normalizedArray)\n\n        if (typeof json.total === \"number\") {\n          setTotalFromAPI(json.total)\n        } else if (typeof json.totalCount === \"number\") {\n          setTotalFromAPI(json.totalCount)\n        } else {\n          setTotalFromAPI(normalizedArray.length)\n        }\n      } catch (error) {\n        console.error(\"Error fetching applicants:\", error)\n        setApplicants([])\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    fetchApplicants()\n  }, [])\n\n  const approvedCount = applicants.filter((app) => app.normalizedStatus === \"approved\").length\n  const pendingCount = applicants.filter((app) => app.normalizedStatus === \"pending\").length\n  const rejectedCount = applicants.filter((app) => app.normalizedStatus === \"rejected\").length\n\n  const todayISO = new Date().toISOString().split(\"T\")[0]\n  const todaysSubmissions = applicants.filter((app) => {\n    if (!app.createdAt) return false\n    try {\n      const createdISO = new Date(app.createdAt).toISOString().split(\"T\")[0]\n      return createdISO === todayISO\n    } catch {\n      return app.createdAt?.toString().startsWith(todayISO)\n    }\n  }).length\n\n  const uniqueStatuses = [...new Set(applicants.map((a) => a.normalizedStatus || \"\"))]\n    .filter(Boolean)\n    .sort()\n    .map((s) => s.charAt(0).toUpperCase() + s.slice(1))\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100\">\n      {/* Header */}\n      <header className=\"bg-white border-b border-gray-200 px-8 py-6 shadow-sm\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-10 h-10 bg-gradient-to-br from-teal-600 to-cyan-600 rounded-full flex items-center justify-center shadow-lg\">\n              <Heart className=\"w-6 h-6 text-white fill-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-900\">Admin Dashboard</h1>\n              <p className=\"text-sm text-gray-500\">Case Management System</p>\n            </div>\n          </div>\n          <button\n            onClick={handleLogout}\n            className=\"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-red-50 hover:text-red-600 rounded-lg transition font-medium\"\n          >\n            <LogOut className=\"w-4 h-4\" />\n            Logout\n          </button>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-8 py-12\">\n        {activeTab === \"overview\" && (\n          <div>\n            <div className=\"mb-8\">\n              <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">Welcome Back</h2>\n              <p className=\"text-gray-600\">Here's an overview of pending applications</p>\n            </div>\n\n            {loading ? (\n              <div className=\"bg-white rounded-lg p-12 text-center\">\n                <p className=\"text-gray-600\">Loading dashboard...</p>\n              </div>\n            ) : (\n              <>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\n                  <StatCard\n                    title=\"Total Applications\"\n                    value={totalFromAPI ?? applicants.length}\n                    icon={<FileText className=\"w-5 h-5\" />}\n                    color=\"from-blue-600 to-cyan-600\"\n                  />\n                  <StatCard\n                    title=\"Pending Review\"\n                    value={pendingCount}\n                    icon={<TrendingUp className=\"w-5 h-5\" />}\n                    color=\"from-yellow-600 to-orange-600\"\n                  />\n                  <StatCard\n                    title=\"Approved\"\n                    value={approvedCount}\n                    icon={<CheckCircle2 className=\"w-5 h-5\" />}\n                    color=\"from-green-600 to-emerald-600\"\n                  />\n                  <StatCard\n                    title=\"New Today\"\n                    value={todaysSubmissions}\n                    icon={<Shield className=\"w-5 h-5\" />}\n                    color=\"from-teal-600 to-cyan-600\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n                  <div className=\"lg:col-span-2 bg-white rounded-lg p-8 shadow-sm border border-gray-200\">\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-8\">Application Status</h3>\n                    <div className=\"space-y-6\">\n                      <StatusRow label=\"Pending\" value={pendingCount} color=\"from-yellow-500 to-orange-500\" />\n                      <StatusRow label=\"Approved\" value={approvedCount} color=\"from-green-500 to-emerald-500\" />\n                      <StatusRow label=\"Rejected\" value={rejectedCount} color=\"from-red-500 to-rose-500\" />\n                    </div>\n                  </div>\n\n                  <div className=\"bg-white rounded-lg p-8 shadow-sm border border-gray-200\">\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-6\">Quick Actions</h3>\n                    <div className=\"space-y-3\">\n                      <Link href=\"/staff/cases\">\n                        <button className=\"w-full px-6 py-3 border-2 border-teal-600 text-teal-600 rounded-lg font-medium hover:bg-teal-50 transition\">\n                          View All Cases\n                        </button>\n                      </Link>\n                      <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n                        <p className=\"text-sm text-blue-800\">\n                          <span className=\"font-semibold\">{pendingCount}</span> applications awaiting review\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction StatCard({ title, value, icon, color = \"text-gray-900\" }: any) {\n  return (\n    <div className=\"bg-white rounded-lg p-6 shadow-sm border border-gray-200 hover:shadow-md transition\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-gray-600 font-medium\">{title}</h3>\n        <div className={`w-10 h-10 bg-gradient-to-br ${color} rounded-lg flex items-center justify-center text-white`}>\n          {icon}\n        </div>\n      </div>\n      <p className=\"text-4xl font-bold text-gray-900\">{value}</p>\n    </div>\n  )\n}\n\nfunction StatusRow({ label, value, color }: any) {\n  return (\n    <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\n      <span className=\"text-gray-700 font-medium\">{label}</span>\n      <div className={`px-4 py-2 bg-gradient-to-r ${color} text-white rounded-lg font-semibold`}>{value}</div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}