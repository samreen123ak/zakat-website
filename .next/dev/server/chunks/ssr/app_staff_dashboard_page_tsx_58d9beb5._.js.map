{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sam_Bhatti/Desktop/Rahmah%20Exchange/Frontend/app/staff/dashboard/page.tsx"],"sourcesContent":["\"use client\"\n\nimport React, { useEffect, useState } from \"react\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/navigation\"\nimport { CheckCircle2, TrendingUp, DollarSign, FileText, Heart } from \"lucide-react\"\n\ntype ZakatApplicant = {\n  id?: string | number\n  status?: string\n  createdAt?: string\n  normalizedStatus?: string\n  [key: string]: any\n}\n\ntype StatCardProps = {\n  title: string\n  value: string | number\n  icon: React.ReactNode\n  color?: string\n}\n\ntype StatusRowProps = {\n  label: string\n  value: number\n  color: string\n}\n\nexport default function DashboardPage() {\n  const [activeTab] = useState(\"overview\")\n  const [applicants, setApplicants] = useState<ZakatApplicant[]>([])\n  const [totalFromAPI, setTotalFromAPI] = useState<number | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [showDebug] = useState(false)\n  const router = useRouter()\n\n  const normalizeStatus = (status?: string) => {\n    return (status || \"\")\n      .toString()\n      .trim()\n      .toLowerCase()\n      .replace(/\\s+/g, \" \")\n  }\n\n  // ✅ Logout handler\n  const handleLogout = async () => {\n    try {\n      const token = localStorage.getItem(\"rahmah_admin_token\")\n\n      // Optional: call backend logout API if you add it\n      await fetch(\"https://rahmah-exchange-backend-production.up.railway.app/api/auth/logout\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n      }).catch(() => {}) // ignore network issues for now\n\n      // ✅ Clear localStorage\n      localStorage.removeItem(\"rahmah_admin_token\")\n\n      // ✅ Redirect to login page\n      router.push(\"/staff/login\")\n\n    } catch (err) {\n      console.error(\"Logout failed:\", err)\n      localStorage.removeItem(\"rahmah_admin_token\")\n      router.push(\"/login\")\n    }\n  }\n\n  // fetch applicants and attach a normalized status for reliable counting\n  useEffect(() => {\n    const fetchApplicants = async () => {\n      try {\n        const res = await fetch(\n          \"https://rahmah-exchange-backend-production.up.railway.app/api/zakatApplicants\"\n        )\n        const json = await res.json()\n\n        const dataArray: any[] = Array.isArray(json)\n          ? json\n          : json.items || json.data || []\n\n        const normalizedArray: ZakatApplicant[] = dataArray.map((a) => ({\n          ...a,\n          normalizedStatus: normalizeStatus(a?.status),\n        }))\n\n        setApplicants(normalizedArray)\n\n        if (typeof json.total === \"number\") {\n          setTotalFromAPI(json.total)\n        } else if (typeof json.totalCount === \"number\") {\n          setTotalFromAPI(json.totalCount)\n        } else {\n          setTotalFromAPI(normalizedArray.length)\n        }\n      } catch (error) {\n        console.error(\"Error fetching applicants:\", error)\n        setApplicants([])\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    fetchApplicants()\n  }, [])\n\n  const approvedCount = applicants.filter((app) => app.normalizedStatus === \"approved\").length\n  const pendingCount = applicants.filter((app) => app.normalizedStatus === \"pending\").length\n  const rejectedCount = applicants.filter((app) => app.normalizedStatus === \"rejected\").length\n\n  const todayISO = new Date().toISOString().split(\"T\")[0]\n  const todaysSubmissions = applicants.filter((app) => {\n    if (!app.createdAt) return false\n    try {\n      const createdISO = new Date(app.createdAt).toISOString().split(\"T\")[0]\n      return createdISO === todayISO\n    } catch {\n      return app.createdAt?.toString().startsWith(todayISO)\n    }\n  }).length\n\n  const uniqueStatuses = [...new Set(applicants.map((a) => a.normalizedStatus || \"\"))]\n    .filter(Boolean)\n    .sort()\n    .map((s) => s.charAt(0).toUpperCase() + s.slice(1))\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-teal-50 to-blue-50\">\n      {/* Header */}\n      <header className=\"bg-white border-b border-gray-200 px-8 py-6\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-8 h-8 bg-teal-600 rounded-full flex items-center justify-center\">\n              <Heart className=\"w-5 h-5 text-white fill-white\" />\n            </div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Admin Dashboard</h1>\n          </div>\n          {/* ✅ Logout Button */}\n          <button\n            onClick={handleLogout}\n            className=\"text-gray-600 hover:text-red-600 transition font-medium\"\n          >\n            Logout\n          </button>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-8 py-12\">\n        {activeTab === \"overview\" && (\n          <div>\n            <h2 className=\"text-xl font-bold text-gray-900 mb-8\">Welcome, To Admin Dashboard</h2>\n\n            {loading ? (\n              <p className=\"text-gray-600\">...</p>\n            ) : (\n              <>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\n                  <StatCard\n                    title=\"Total Applications\"\n                    value={totalFromAPI ?? applicants.length}\n                    icon={<FileText className=\"w-5 h-5 text-gray-400\" />}\n                  />\n                  <StatCard\n                    title=\"New Submissions\"\n                    value={todaysSubmissions}\n                    color=\"text-blue-600\"\n                    icon={<TrendingUp className=\"w-5 h-5 text-blue-600\" />}\n                  />\n                  <StatCard\n                    title=\"Approved\"\n                    value={approvedCount}\n                    color=\"text-green-600\"\n                    icon={<CheckCircle2 className=\"w-5 h-5 text-green-600\" />}\n                  />\n                  <StatCard\n                    title=\"Total Disbursed\"\n                    value={\"$0.00\"}\n                    color=\"text-teal-600\"\n                    icon={<DollarSign className=\"w-5 h-5 text-teal-600\" />}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                  <div className=\"bg-white rounded-lg p-8 shadow-sm\">\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-8\">\n                      Application Status Breakdown\n                    </h3>\n                    <div className=\"space-y-6\">\n                      <StatusRow label=\"Pending\" value={pendingCount} color=\"text-gray-400\" />\n                      <StatusRow label=\"Approved\" value={approvedCount} color=\"text-green-600\" />\n                      <StatusRow label=\"Rejected\" value={rejectedCount} color=\"text-gray-400\" />\n                    </div>\n\n                    {showDebug && (\n                      <div className=\"mt-6 text-sm text-gray-600\">\n                        <div>Unique statuses: {uniqueStatuses.join(\", \")}</div>\n                        <div>Total raw applicants: {applicants.length}</div>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"bg-white rounded-lg p-8 shadow-sm\">\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-8\">Quick Actions</h3>\n                    <div className=\"space-y-4\">\n                      <Link href=\"/staff/cases\">\n                        <button className=\"w-full px-6 py-3 border border-gray-300 rounded-lg text-gray-900 font-medium hover:bg-gray-50 transition text-left flex items-center gap-3\">\n                          <FileText className=\"w-5 h-5 text-gray-600\" />\n                          View All Cases\n                        </button>\n                      </Link>\n                      <button className=\"w-full px-6 py-3 border border-gray-300 rounded-lg text-gray-900 font-medium hover:bg-gray-50 transition text-left flex items-center gap-3\">\n                        <TrendingUp className=\"w-5 h-5 text-gray-600\" />\n                        Pending Approvals\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction StatCard({ title, value, icon, color = \"text-gray-900\" }: StatCardProps) {\n  return (\n    <div className=\"bg-white rounded-lg p-6 shadow-sm\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-gray-600 font-medium\">{title}</h3>\n        {icon}\n      </div>\n      <p className={`text-4xl font-bold ${color}`}>{value}</p>\n    </div>\n  )\n}\n\nfunction StatusRow({ label, value, color }: StatusRowProps) {\n  return (\n    <div className=\"flex items-center justify-between\">\n      <span className=\"text-gray-700\">{label}</span>\n      <span className={`text-lg font-semibold ${color}`}>{value}</span>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AALA;;;;;;AA4Be,SAAS;IACtB,MAAM,CAAC,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAC7B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAmB,EAAE;IACjE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAgB;IAChE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAC7B,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,kBAAkB,CAAC;QACvB,OAAO,CAAC,UAAU,EAAE,EACjB,QAAQ,GACR,IAAI,GACJ,WAAW,GACX,OAAO,CAAC,QAAQ;IACrB;IAEA,mBAAmB;IACnB,MAAM,eAAe;QACnB,IAAI;YACF,MAAM,QAAQ,aAAa,OAAO,CAAC;YAEnC,kDAAkD;YAClD,MAAM,MAAM,6EAA6E;gBACvF,QAAQ;gBACR,SAAS;oBACP,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;gBAClC;YACF,GAAG,KAAK,CAAC,KAAO,IAAG,gCAAgC;YAEnD,uBAAuB;YACvB,aAAa,UAAU,CAAC;YAExB,2BAA2B;YAC3B,OAAO,IAAI,CAAC;QAEd,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,kBAAkB;YAChC,aAAa,UAAU,CAAC;YACxB,OAAO,IAAI,CAAC;QACd;IACF;IAEA,wEAAwE;IACxE,IAAA,kNAAS,EAAC;QACR,MAAM,kBAAkB;YACtB,IAAI;gBACF,MAAM,MAAM,MAAM,MAChB;gBAEF,MAAM,OAAO,MAAM,IAAI,IAAI;gBAE3B,MAAM,YAAmB,MAAM,OAAO,CAAC,QACnC,OACA,KAAK,KAAK,IAAI,KAAK,IAAI,IAAI,EAAE;gBAEjC,MAAM,kBAAoC,UAAU,GAAG,CAAC,CAAC,IAAM,CAAC;wBAC9D,GAAG,CAAC;wBACJ,kBAAkB,gBAAgB,GAAG;oBACvC,CAAC;gBAED,cAAc;gBAEd,IAAI,OAAO,KAAK,KAAK,KAAK,UAAU;oBAClC,gBAAgB,KAAK,KAAK;gBAC5B,OAAO,IAAI,OAAO,KAAK,UAAU,KAAK,UAAU;oBAC9C,gBAAgB,KAAK,UAAU;gBACjC,OAAO;oBACL,gBAAgB,gBAAgB,MAAM;gBACxC;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8BAA8B;gBAC5C,cAAc,EAAE;YAClB,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG,EAAE;IAEL,MAAM,gBAAgB,WAAW,MAAM,CAAC,CAAC,MAAQ,IAAI,gBAAgB,KAAK,YAAY,MAAM;IAC5F,MAAM,eAAe,WAAW,MAAM,CAAC,CAAC,MAAQ,IAAI,gBAAgB,KAAK,WAAW,MAAM;IAC1F,MAAM,gBAAgB,WAAW,MAAM,CAAC,CAAC,MAAQ,IAAI,gBAAgB,KAAK,YAAY,MAAM;IAE5F,MAAM,WAAW,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACvD,MAAM,oBAAoB,WAAW,MAAM,CAAC,CAAC;QAC3C,IAAI,CAAC,IAAI,SAAS,EAAE,OAAO;QAC3B,IAAI;YACF,MAAM,aAAa,IAAI,KAAK,IAAI,SAAS,EAAE,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACtE,OAAO,eAAe;QACxB,EAAE,OAAM;YACN,OAAO,IAAI,SAAS,EAAE,WAAW,WAAW;QAC9C;IACF,GAAG,MAAM;IAET,MAAM,iBAAiB;WAAI,IAAI,IAAI,WAAW,GAAG,CAAC,CAAC,IAAM,EAAE,gBAAgB,IAAI;KAAK,CACjF,MAAM,CAAC,SACP,IAAI,GACJ,GAAG,CAAC,CAAC,IAAM,EAAE,MAAM,CAAC,GAAG,WAAW,KAAK,EAAE,KAAK,CAAC;IAElD,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAO,WAAU;0BAChB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,6MAAK;wCAAC,WAAU;;;;;;;;;;;8CAEnB,8OAAC;oCAAG,WAAU;8CAAmC;;;;;;;;;;;;sCAGnD,8OAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;0BAOL,8OAAC;gBAAI,WAAU;0BACZ,cAAc,4BACb,8OAAC;;sCACC,8OAAC;4BAAG,WAAU;sCAAuC;;;;;;wBAEpD,wBACC,8OAAC;4BAAE,WAAU;sCAAgB;;;;;iDAE7B;;8CACE,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,OAAM;4CACN,OAAO,gBAAgB,WAAW,MAAM;4CACxC,oBAAM,8OAAC,0NAAQ;gDAAC,WAAU;;;;;;;;;;;sDAE5B,8OAAC;4CACC,OAAM;4CACN,OAAO;4CACP,OAAM;4CACN,oBAAM,8OAAC,gOAAU;gDAAC,WAAU;;;;;;;;;;;sDAE9B,8OAAC;4CACC,OAAM;4CACN,OAAO;4CACP,OAAM;4CACN,oBAAM,8OAAC,qOAAY;gDAAC,WAAU;;;;;;;;;;;sDAEhC,8OAAC;4CACC,OAAM;4CACN,OAAO;4CACP,OAAM;4CACN,oBAAM,8OAAC,gOAAU;gDAAC,WAAU;;;;;;;;;;;;;;;;;8CAIhC,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAG,WAAU;8DAAuC;;;;;;8DAGrD,8OAAC;oDAAI,WAAU;;sEACb,8OAAC;4DAAU,OAAM;4DAAU,OAAO;4DAAc,OAAM;;;;;;sEACtD,8OAAC;4DAAU,OAAM;4DAAW,OAAO;4DAAe,OAAM;;;;;;sEACxD,8OAAC;4DAAU,OAAM;4DAAW,OAAO;4DAAe,OAAM;;;;;;;;;;;;gDAGzD,2BACC,8OAAC;oDAAI,WAAU;;sEACb,8OAAC;;gEAAI;gEAAkB,eAAe,IAAI,CAAC;;;;;;;sEAC3C,8OAAC;;gEAAI;gEAAuB,WAAW,MAAM;;;;;;;;;;;;;;;;;;;sDAKnD,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAG,WAAU;8DAAuC;;;;;;8DACrD,8OAAC;oDAAI,WAAU;;sEACb,8OAAC,uKAAI;4DAAC,MAAK;sEACT,cAAA,8OAAC;gEAAO,WAAU;;kFAChB,8OAAC,0NAAQ;wEAAC,WAAU;;;;;;oEAA0B;;;;;;;;;;;;sEAIlD,8OAAC;4DAAO,WAAU;;8EAChB,8OAAC,gOAAU;oEAAC,WAAU;;;;;;gEAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAaxE;AAEA,SAAS,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,eAAe,EAAiB;IAC9E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA6B;;;;;;oBAC1C;;;;;;;0BAEH,8OAAC;gBAAE,WAAW,CAAC,mBAAmB,EAAE,OAAO;0BAAG;;;;;;;;;;;;AAGpD;AAEA,SAAS,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAkB;IACxD,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAK,WAAU;0BAAiB;;;;;;0BACjC,8OAAC;gBAAK,WAAW,CAAC,sBAAsB,EAAE,OAAO;0BAAG;;;;;;;;;;;;AAG1D","debugId":null}}]
}